<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><meta name="description" content="这次写了两道的wp, 第一道u3d的游戏队友出得比我快, 就没写了.                     d3thon       打开一看发现是python导入pyd一类的东西, 用python3.10可以跑起来. lbc包含了指令的逻辑, byte_analizer.so是类似解释器的东西, pyd的逆向非常困难, 所以我直接通过输入输出来猜测lbc文件中的逻辑. (byte_ananli">
<meta property="og:type" content="article">
<meta property="og:title" content="d3ctf">
<meta property="og:url" content="https://yimianweishi.github.io/2022/03/15/d3ctf/index.html">
<meta property="og:site_name" content="marginal&#39;s blog">
<meta property="og:description" content="这次写了两道的wp, 第一道u3d的游戏队友出得比我快, 就没写了.                     d3thon       打开一看发现是python导入pyd一类的东西, 用python3.10可以跑起来. lbc包含了指令的逻辑, byte_analizer.so是类似解释器的东西, pyd的逆向非常困难, 所以我直接通过输入输出来猜测lbc文件中的逻辑. (byte_ananli">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://yimianweishi.github.io/d3ctf/Untitled.png">
<meta property="article:published_time" content="2022-03-15T15:16:26.000Z">
<meta property="article:modified_time" content="2022-03-15T16:13:36.474Z">
<meta property="article:author" content="marginal">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yimianweishi.github.io/d3ctf/Untitled.png"><title>d3ctf | marginal's blog</title><link ref="canonical" href="https://yimianweishi.github.io/2022/03/15/d3ctf/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":false},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.4.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">marginal's blog</div><div class="header-banner-info__subtitle"></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">d3ctf</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2022-03-15</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2022-03-16</span></span></div></header><div class="post-body"><p>这次写了两道的wp, 第一道u3d的游戏队友出得比我快, 就没写了.</p>

        <h2 id="d3thon"   >
          <a href="#d3thon" class="heading-link"><i class="fas fa-link"></i></a><a href="#d3thon" class="headerlink" title="d3thon"></a>d3thon</h2>
      <p>打开一看发现是python导入pyd一类的东西, 用python3.10可以跑起来.</p>
<p>lbc包含了指令的逻辑, byte_analizer.so是类似解释器的东西, pyd的逆向非常困难, 所以我直接通过输入输出来猜测lbc文件中的逻辑. (byte_ananlizer有成员Variables来获得变量值</p>
<p>结果如下</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">kZslMZYnvPBwgdCz   print</span><br><span class="line">oGwDokoxZgoeViFcAF 赋值(如果赋值为KezJKhCxGRZnfLCGT, 则为输入</span><br><span class="line">RDDDZUiIKbxCubJEN  jmp</span><br><span class="line">todeVDuRkYSIITaT   转为2进制</span><br><span class="line">uPapnsSbmeJLjin    转为10进制</span><br><span class="line">kuhisCvwaXWfqCs    -flag - 1</span><br><span class="line">IEKMEDdrPpzpdKy    add</span><br><span class="line">OcKUQCYqhwHXfAgGZH  xor</span><br><span class="line">FLNPsiCIvICFtzpUAR sub</span><br><span class="line">OuGFUKNGxNLeHOudCK cmp</span><br></pre></td></tr></table></div></figure>

<p>lbc中加密的逻辑为</p>
<p>把非01的字符转为ord值, 再转为2进制, 2进制字符串串联起来, 转为10进制, 最后进行运算</p>
<p>解题脚本:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#a是那一堆很复杂的运算</span><br><span class="line">k = &#123;&#125;</span><br><span class="line">for i in range(2,10):</span><br><span class="line">    k[str(i)] = &quot;&#123;0:b&#125;&quot;.format(ord(str(i))).zfill(8)</span><br><span class="line"></span><br><span class="line">for i in range(97, 123):</span><br><span class="line">    k[chr(i)]=&quot;&#123;0:b&#125;&quot;.format(i).zfill(8)</span><br><span class="line"></span><br><span class="line">b = -194952731925593882593246917508862867371733438849523064153861650948471779982880938</span><br><span class="line">i = len(a) - 1</span><br><span class="line">while i &gt;= 0:</span><br><span class="line">    if (a[i - 1] == &quot;xor&quot;): </span><br><span class="line">        b ^= int(a[i])</span><br><span class="line">        i -= 2</span><br><span class="line">    elif (a[i - 1] == &quot;add&quot;):</span><br><span class="line">        b -= int(a[i])</span><br><span class="line">        i -= 2</span><br><span class="line">    elif (a[i - 1] == &quot;sub&quot;):</span><br><span class="line">        b += int(a[i])</span><br><span class="line">        i -= 2</span><br><span class="line">    elif (a[i] == &quot;????????:flag&quot;):  #-flag - 1的运算</span><br><span class="line">        b = -b - 1</span><br><span class="line">        i -= 1</span><br><span class="line">    else :</span><br><span class="line">        print(&quot;error&quot;)</span><br><span class="line">    </span><br><span class="line">c = bin(b)[2:]</span><br><span class="line"></span><br><span class="line">s = &quot;&quot;</span><br><span class="line">i = len(c)</span><br><span class="line">while i &gt;= 8:</span><br><span class="line">    for key, value in k.items():</span><br><span class="line">        if (c[i - 8:i] == k[key]):</span><br><span class="line">            s = key + s</span><br><span class="line">            i -= 8</span><br><span class="line">            break</span><br><span class="line">print(s)</span><br><span class="line">print(i)</span><br><span class="line">#1101000011011100110010001110010110000100110100011000010011011001100010011000100110010001100100001101000110010000110111001110000110001100111001001101000110010100110#11000110010001100100011100100110010001101010011011101100001011001100011001100110101 01100101</span><br><span class="line">#4729a4a6bbdd4d78c94e6229257af35e</span><br></pre></td></tr></table></div></figure>


        <h2 id="d3w0w"   >
          <a href="#d3w0w" class="heading-link"><i class="fas fa-link"></i></a><a href="#d3w0w" class="headerlink" title="d3w0w"></a><strong>d3w0w</strong></h2>
      <p>这个题目感觉是一个迷宫题, 要求迷宫得玩家打造那种, 并且给出了迷宫的要求</p>
<p>对输入的转化(输入只能由39位, 减去前缀, 只有32位)</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">case &#x27;1&#x27;:</span><br><span class="line">        *(_DWORD *)(a2 + 24 * v5 + 4 * v4) |= 8u;// 上</span><br><span class="line">        *(_DWORD *)(a2 + 24 * --v5 + 4 * v4) |= 2u;</span><br><span class="line">        goto LABEL_14;</span><br><span class="line">      case &#x27;2&#x27;:</span><br><span class="line">        *(_DWORD *)(a2 + 24 * v5 + 4 * v4) |= 2u;// 下</span><br><span class="line">        *(_DWORD *)(a2 + 24 * ++v5 + 4 * v4) |= 8u;</span><br><span class="line">        goto LABEL_14;</span><br><span class="line">      case &#x27;3&#x27;:</span><br><span class="line">        *(_DWORD *)(a2 + 24 * v5 + 4 * v4) |= 4u;// 左</span><br><span class="line">        *(_DWORD *)(a2 + 24 * v5 + 4 * v4-- - 4) |= 1u;</span><br><span class="line">        goto LABEL_14;</span><br><span class="line">      case &#x27;4&#x27;:</span><br><span class="line">        *(_DWORD *)(a2 + 24 * v5 + 4 * v4) |= 1u;// 右</span><br><span class="line">        *(_DWORD *)(a2 + 24 * v5 + 4 * v4++ + 4) |= 4u;</span><br></pre></td></tr></table></div></figure>

<p>输入转化的值,只看低4位:</p>
<p>第4位表示能往上走, 第3位表示能向左走, 第2位表示能向下走, 第1位表示能向右走, 设置迷宫时只能一步步顺序设置.</p>
<p>迷宫校验为64位模式进行校验, 所以得从64位的角度进行反编译</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line">for ( i = 0; i &lt; 6; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    for ( j = 0; j &lt; 6; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( (unsigned int)retaddr[6 * i + j] &gt; 0xF )</span><br><span class="line">        return 1i64;</span><br><span class="line">      v16 = retaddr[6 * i + j] % 0x10u / 8;</span><br><span class="line">      v24 = j;</span><br><span class="line">      v17 = retaddr[6 * i + j] % 8u / 4 + v16;</span><br><span class="line">      v25 = j;</span><br><span class="line">      v18 = retaddr[6 * i + j] % 4u / 2 + v17;</span><br><span class="line">      v26 = j;</span><br><span class="line">      if ( retaddr[6 * i + j] % 2u + v18 &gt; 2 )  //每个点的通道不能超过两个</span><br><span class="line">        return 1i64;</span><br><span class="line">			//检验边界</span><br><span class="line">      if ( !j &amp;&amp; retaddr[6 * i] % 8u / 4 )</span><br><span class="line">        return 1i64;</span><br><span class="line">      if ( j == 5 &amp;&amp; retaddr[6 * i + 5] % 2u )</span><br><span class="line">        return 1i64;</span><br><span class="line">      if ( !i &amp;&amp; retaddr[j] % 0x10u / 8 )</span><br><span class="line">        return 1i64;</span><br><span class="line">      if ( i == 5 &amp;&amp; retaddr[j + 30] % 4u / 2 )</span><br><span class="line">        return 1i64;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">//特殊点1</span><br><span class="line">for ( k = 0; (unsigned __int64)k &lt; 3; ++k )</span><br><span class="line">  &#123;</span><br><span class="line">    v4 = v22[k] / 10;</span><br><span class="line">    v7 = v22[k] % 10;</span><br><span class="line">//结合下面的条件, 方向必须垂直</span><br><span class="line">    if ( retaddr[6 * v4 + v7] % 0x10u / 8 &amp;&amp; retaddr[6 * v4 + v7] % 4u / 2 ) </span><br><span class="line">      return 1i64;</span><br><span class="line">    if ( retaddr[6 * v4 + v7] % 8u / 4 &amp;&amp; retaddr[6 * v4 + v7] % 2u )</span><br><span class="line">      return 1i64;</span><br><span class="line">    v19 = retaddr[6 * v4 + v7] % 0x10u / 8;</span><br><span class="line">    v27 = v7;</span><br><span class="line">    v20 = retaddr[6 * v4 + v7] % 4u / 2 + v19;</span><br><span class="line">    v28 = v7;</span><br><span class="line">    v21 = retaddr[6 * v4 + v7] % 2u + v20;</span><br><span class="line">    v29 = v7;</span><br><span class="line">    if ( retaddr[6 * v4 + v7] % 8u / 4 + v21 != 2 )  //必须有两个通道</span><br><span class="line">      return 1i64;</span><br><span class="line">		//此节点通向的第一个点和该点有相同方向通道(该节点通向的第一个节点的方向)</span><br><span class="line">    if ( retaddr[6 * v4 + v7] % 0x10u / 8 ) </span><br><span class="line">    &#123;</span><br><span class="line">      if ( !(retaddr[6 * v4 - 6 + v7] % 0x10u / 8) )</span><br><span class="line">        return 1i64;</span><br><span class="line">    &#125;</span><br><span class="line">    else if ( retaddr[6 * v4 + v7] % 4u / 2 )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( !(retaddr[6 * v4 + 6 + v7] % 4u / 2) )</span><br><span class="line">        return 1i64;</span><br><span class="line">    &#125;</span><br><span class="line">    else if ( retaddr[6 * v4 + v7] % 8u / 4 )</span><br><span class="line">    &#123;</span><br><span class="line">      if ( !(retaddr[6 * v4 - 1 + v7] % 8u / 4) )</span><br><span class="line">        return 1i64;</span><br><span class="line">    &#125;</span><br><span class="line">    else if ( retaddr[6 * v4 + v7] % 2u &amp;&amp; !(retaddr[6 * v4 + 1 + v7] % 2u) )</span><br><span class="line">    &#123;</span><br><span class="line">      return 1i64;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">//特殊点二2</span><br><span class="line">for ( m = 0; (unsigned __int64)m &lt; 0xA; ++m )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = v23[m] / 10;</span><br><span class="line">    v8 = v23[m] % 10;</span><br><span class="line">//方向必须平行</span><br><span class="line">    if ( (!(retaddr[6 * v5 + v8] % 0x10u / 8) || !(retaddr[6 * v5 + v8] % 4u / 2))</span><br><span class="line">      &amp;&amp; (!(retaddr[6 * v5 + v8] % 8u / 4) || !(retaddr[6 * v5 + v8] % 2u)) )</span><br><span class="line">    &#123;</span><br><span class="line">      return 1i64;</span><br><span class="line">    &#125;</span><br><span class="line">//必须有通道垂直该节点的方向</span><br><span class="line">    if ( retaddr[6 * v5 + v8] % 0x10u / 8</span><br><span class="line">      &amp;&amp; retaddr[6 * v5 + v8] % 4u / 2</span><br><span class="line">      &amp;&amp; !(retaddr[6 * v5 - 6 + v8] % 8u / 4)</span><br><span class="line">      &amp;&amp; !(retaddr[6 * v5 - 6 + v8] % 2u)</span><br><span class="line">      &amp;&amp; !(retaddr[6 * v5 + 6 + v8] % 8u / 4)</span><br><span class="line">      &amp;&amp; !(retaddr[6 * v5 + 6 + v8] % 2u) )</span><br><span class="line">    &#123;</span><br><span class="line">      return 1i64;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( retaddr[6 * v5 + v8] % 8u / 4</span><br><span class="line">      &amp;&amp; retaddr[6 * v5 + v8] % 2u</span><br><span class="line">      &amp;&amp; !(retaddr[6 * v5 + 1 + v8] % 0x10u / 8)</span><br><span class="line">      &amp;&amp; !(retaddr[6 * v5 + 1 + v8] % 4u / 2)</span><br><span class="line">      &amp;&amp; !(retaddr[6 * v5 - 1 + v8] % 0x10u / 8)</span><br><span class="line">      &amp;&amp; !(retaddr[6 * v5 - 1 + v8] % 4u / 2) )</span><br><span class="line">    &#123;</span><br><span class="line">      return 1i64;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">//上下左右的顺序寻路, 不能返回上个节点, 要求回到原点</span><br><span class="line">if ( *retaddr % 0x10u / 8 )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = -1;</span><br><span class="line">    do</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_79:</span><br><span class="line">      if ( !(retaddr[6 * v6 + v9] % 0x10u / 8) || v6 - 1 == v12 &amp;&amp; v9 == v13 )</span><br><span class="line">      &#123;</span><br><span class="line">        if ( !(retaddr[6 * v6 + v9] % 4u / 2) || v6 + 1 == v12 &amp;&amp; v9 == v13 )</span><br><span class="line">        &#123;</span><br><span class="line">          if ( !(retaddr[6 * v6 + v9] % 8u / 4) || v6 == v12 &amp;&amp; v9 - 1 == v13 )</span><br><span class="line">          &#123;</span><br><span class="line">            if ( !(retaddr[6 * v6 + v9] % 2u) || v6 == v12 &amp;&amp; v9 + 1 == v13 )</span><br><span class="line">							//走到死胡同</span><br><span class="line">              return 1i64;</span><br><span class="line">            v12 = v6;</span><br><span class="line">            v13 = v9++;</span><br><span class="line">          &#125;</span><br><span class="line">          else</span><br><span class="line">          &#123;</span><br><span class="line">            v12 = v6;</span><br><span class="line">            v13 = v9--;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        else</span><br><span class="line">        &#123;</span><br><span class="line">          v12 = v6;</span><br><span class="line">          v13 = v9;</span><br><span class="line">          ++v6;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      else</span><br><span class="line">      &#123;</span><br><span class="line">        v12 = v6;</span><br><span class="line">        v13 = v9;</span><br><span class="line">        --v6;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    while ( v6 || v9 );</span><br><span class="line">    return 0i64;</span><br><span class="line">  &#125;</span><br><span class="line">  else</span><br><span class="line">  &#123;</span><br><span class="line">    if ( *retaddr % 4u / 2 )</span><br><span class="line">    &#123;</span><br><span class="line">      v6 = 1;</span><br><span class="line">      goto LABEL_79;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( *retaddr % 8u / 4 )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = -1;</span><br><span class="line">      goto LABEL_79;</span><br><span class="line">    &#125;</span><br><span class="line">    if ( *retaddr % 2u )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = 1;</span><br><span class="line">      goto LABEL_79;</span><br><span class="line">    &#125;</span><br><span class="line">    return 1i64;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>

<p>最后画图</p>
<p><img src="/d3ctf/Untitled.png" alt="Untitled"></p>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="https://yimianweishi.github.io">marginal</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="https://yimianweishi.github.io/2022/03/15/d3ctf/">https://yimianweishi.github.io/2022/03/15/d3ctf/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> unless stating additionally</span></div></div><nav class="post-paginator paginator"><div class="paginator-next"><a class="paginator-next__link" href="/2022/01/04/SCTF-low-re/"><span class="paginator-prev__text">SCTF low_re</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#d3thon"><span class="toc-number">1.</span> <span class="toc-text">
          d3thon</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#d3w0w"><span class="toc-number">2.</span> <span class="toc-text">
          d3w0w</span></a></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/images/icons/stun-logo.svg" alt="avatar"></div><p class="sidebar-ov-author__text">marginal</p></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">17</div><div class="sidebar-ov-state-item__name">Archives</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2022</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>marginal</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v5.4.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script></body></html>